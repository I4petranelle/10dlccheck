<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>SMS Sandbox ‚Äî 10dlccheck</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="description" content="Test SMS without sending real texts. Simulate delivery, quiet hours and carrier filtering. Privacy-first: no tracking cookies." />

  <!-- Tailwind -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            ink:"#0B1220", // deep navy for dark header
            onyx:"#131C2B",
            snow:"#ffffff",
            sky:"#1E88E5", // primary blue
            line:"#E5E7EB",
            bg:"#F3F6FB"
          },
          boxShadow: {
            card: "0 14px 40px rgba(2,6,23,.10)",
            pill: "0 10px 24px rgba(30,136,229,.32)",
            soft: "0 6px 18px rgba(2,6,23,.08)"
          }
        }
      }
    };
  </script>

  <style>
  :root {
    --ink: #0B1220;
    --onyx: #131C2B;
    --sky: #1E88E5;
    --bg: #F3F6FB;
  }

  body {
    background: var(--bg);
    color: #0f172a;
    font-family: system-ui, -apple-system, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
  }

  /* ====== Full-width Inputs ====== */
  .input,
  .textarea {
    width: 100%;
    display: block;
    box-sizing: border-box;
    border-radius: 16px;
    border: 1.8px solid #d1d5db;
    background: #fff;
    color: #111827;
    padding: 1rem 1.25rem;
    font-size: 16px;
    line-height: 1.5;
    transition: all 0.15s ease-in-out;
  }

  .input:focus,
  .textarea:focus {
    border-color: var(--sky);
    box-shadow: 0 0 0 3px rgba(30, 136, 229, 0.25);
    outline: none;
  }

  .textarea {
    min-height: 140px;
    resize: vertical;
  }

  label {
    display: block;
    margin-bottom: 0.4rem;
    font-weight: 600;
    color: #0f172a;
  }

  .grid > div {
    width: 100%;
  }

  /* ====== Buttons ====== */
  .btn {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    gap: 0.5rem;
    padding: 0.85rem 1.6rem;
    border-radius: 9999px;
    cursor: pointer;
    user-select: none;
    font-weight: 600;
    font-size: 15px;
    line-height: 1;
    transition: transform 0.08s ease, filter 0.12s ease, box-shadow 0.12s ease, background-color 0.12s ease;
    border: 2px solid transparent;
    background: #fff;
    color: #111827;
  }

  .btn:focus-visible {
    outline: none;
    box-shadow: 0 0 0 3px rgba(30, 136, 229, 0.35), 0 10px 22px rgba(30, 136, 229, 0.18);
    transform: translateY(-1px);
  }

  .btn:active {
    transform: translateY(0);
  }

  /* Primary (Blue) */
  .btn-primary {
    background: var(--sky);
    color: #fff;
    border: none;
    box-shadow: 0 6px 16px rgba(30, 136, 229, 0.35);
  }

  .btn-primary:hover {
    background: #1976d2;
    transform: translateY(-1px);
  }

  /* Outline */
  .btn-outline {
    background: #fff;
    color: #0f172a;
    border: 2px solid #d1d5db;
    box-shadow: 0 4px 10px rgba(2, 6, 23, 0.06);
  }

  .btn-outline:hover {
    background: #f8fafc;
    border-color: #bfc6cf;
    transform: translateY(-1px);
  }

  /* Ghost */
  .btn-ghost {
    background: transparent;
    color: #374151;
  }

  .btn-ghost:hover {
    background: #f3f4f6;
  }

  /* Button Row */
  .button-row {
    display: flex;
    flex-wrap: wrap;
    align-items: center;
    gap: 1rem;
    margin-top: 0.75rem;
  }

  /* ====== Phone Frame ====== */
  .phone-wrap {
    background: linear-gradient(135deg, #0f172a 0%, #233047 38%, #0b1322 100%);
    padding: 16px;
    border-radius: 36px;
    box-shadow: 0 20px 44px rgba(2, 6, 23, 0.35);
  }

  .phone-bezel {
    background: #000;
    border-radius: 28px;
    padding: 12px;
    box-shadow: inset 0 0 0 1px rgba(255, 255, 255, 0.06);
  }

  .phone-screen {
    background: #fff;
    border-radius: 24px;
    overflow: hidden;
    position: relative;
  }

  .phone-notch {
    width: 44%;
    height: 18px;
    background: #000;
    border-bottom-left-radius: 12px;
    border-bottom-right-radius: 12px;
    position: absolute;
    left: 50%;
    transform: translateX(-50%);
    top: 0;
    z-index: 10;
  }

  .phone-home {
    width: 34%;
    height: 5px;
    background: #11182715;
    border-radius: 999px;
    margin: 10px auto 12px;
  }

  .chat-bg {
    background: linear-gradient(180deg, #f8fafc 0%, #ffffff 60%);
  }
</style>

</head>
<body>

  <!-- ===== Header (auto-load your template) ===== -->
  <div id="site-header"></div>

  <!-- ===== Dark hero ===== -->
  <section class="bg-ink text-white">
    <div class="max-w-6xl mx-auto px-4 pt-10 pb-6">
      <div class="rounded-3xl bg-onyx shadow-card">
        <div class="px-6 sm:px-8 py-8">
          <div class="grid lg:grid-cols-2 gap-10 items-center">
            <div>
              <h1 class="text-3xl lg:text-4xl font-extrabold tracking-tight">10DLC Compliance Checker &amp; SMS Sandbox</h1>
              <p class="mt-3 text-white/80 text-[15px] leading-7">
                Test SMS content without sending real messages. Simulate carrier delivery, <span class="font-semibold">Quiet Hours</span> and
                <span class="font-semibold">filter probability</span>. Privacy-first: <span class="underline decoration-white/40">no tracking cookies</span>.
              </p>
              <div class="mt-5 flex flex-wrap gap-3 text-sm">
                <span class="inline-flex items-center gap-2 bg-white/10 backdrop-blur rounded-full px-3 py-1.5">
                  ‚úÖ No real SMS sent
                </span>
                <span class="inline-flex items-center gap-2 bg-white/10 backdrop-blur rounded-full px-3 py-1.5">
                  üîí HTTPS secured
                </span>
                <span class="inline-flex items-center gap-2 bg-white/10 backdrop-blur rounded-full px-3 py-1.5">
                  üç™ No tracking cookies
                </span>
              </div>
            </div>

            <div class="hidden lg:block">
              <div class="phone-wrap mx-auto w-full max-w-sm">
                <div class="phone-bezel">
                  <div class="phone-screen">
                    <div class="phone-notch"></div>
                    <div class="flex items-center justify-between text-[11px] text-gray-700/80 px-3 pt-4 pb-2">
                      <span id="phoneTimeHero"></span>
                      <div class="flex items-center gap-1">
                        <span class="inline-block w-2 h-2 rounded-full bg-gray-700/80"></span>
                        <span class="inline-block w-2 h-2 rounded-full bg-gray-700/80"></span>
                        <span class="inline-block w-4 h-2 bg-gray-700/80 rounded-sm"></span>
                      </div>
                    </div>
                    <div class="chat-bg border-t border-gray-200/70 px-3 pb-2">
                      <div class="pt-3 space-y-3 h-[260px] overflow-hidden">
                        <div class="mr-auto max-w-[80%] bg-gray-100 text-gray-900 rounded-2xl px-3 py-2 shadow">Welcome to SMS Sandbox üëã</div>
                        <div class="ml-auto max-w-[80%] text-white rounded-2xl px-3 py-2 shadow" style="background:var(--sky)">Testing a message‚Ä¶</div>
                        <div class="mr-auto max-w-[80%] bg-gray-100 text-gray-900 rounded-2xl px-3 py-2 shadow">DLR: DELIVERED ‚Ä¢ Risk 5</div>
                      </div>
                    </div>
                    <div class="phone-home"></div>
                  </div>
                </div>
              </div>
            </div>
          </div><!--/grid-->
        </div>
      </div>
    </div>
  </section>
	  <!-- Sandbox Intro (Business Friendly, with Trust Badge) -->
<section class="sandbox-intro" style="
  background:linear-gradient(180deg,#0B1220 0%,#131C2B 80%);
  color:#F8FAFC;
  padding:48px 24px 40px;
  text-align:center;
  border-bottom:1px solid rgba(255,255,255,0.1);
">
  <div style="max-width:820px;margin:0 auto;">
    <h1 style="font-size:clamp(1.6rem,2.8vw,2.2rem);font-weight:700;margin-bottom:16px;line-height:1.3;">
      10DLC Message Sandbox for Businesses
    </h1>
    <p style="font-size:1.05rem;line-height:1.75;margin-bottom:18px;color:rgba(255,255,255,0.9);">
      If you send text messages to customers, this sandbox helps you stay compliant before you send them.
      It simulates how major U.S. carriers such as AT&amp;T, Verizon and T-Mobile review your messages
      for potential 10DLC issues like restricted words, payment requests or missing opt-outs.
    </p>
    <p style="font-size:1.05rem;line-height:1.75;margin-bottom:18px;color:rgba(255,255,255,0.9);">
      Type a text message below to preview delivery results, filter risks and best practice feedback.
      You will see whether your campaign would be <strong>delivered, delayed or blocked</strong> without
      sending a real SMS. This is an easy way for small teams and marketers to test their content
      against <a href="/learn/ctia-guidelines-explained" style="color:#58AEDD;font-weight:600;text-decoration:none;">CTIA and 10DLC compliance guidelines explained</a>.
    </p>
    <p style="font-size:0.95rem;line-height:1.6;color:rgba(255,255,255,0.8);margin-bottom:24px;">
      üí° Tip: Messages that mention loans, payments or personal details are often flagged by carriers. Use this tool to
      review and adjust your message before launching your campaign.
    </p>

    <!-- Trust Badge -->
    <div style="display:inline-flex;align-items:center;gap:.6rem;padding:.75rem 1.25rem;border-radius:9999px;
                background:rgba(255,255,255,0.1);border:1px solid rgba(255,255,255,0.15);
                font-size:.9rem;font-weight:500;color:#E2E8F0;">
      <svg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke-width='2'
           stroke='#58AEDD' width='18' height='18'><path stroke-linecap='round' stroke-linejoin='round'
           d='M9 12.75L11.25 15 15 9.75M21 12a9 9 0 11-18 0 9 9 0 0118 0z' /></svg>
      100% Private Sandbox ¬∑ No Tracking Cookies ¬∑ No Data Stored
    </div>
  </div>
</section>

  <!-- ===== Main (white) ===== -->
  <main class="max-w-6xl mx-auto px-4 py-10">
    <div class="grid lg:grid-cols-2 gap-8">
      <!-- Controls -->
      <section class="bg-white rounded-3xl p-6 shadow-card">
        <h2 class="text-xl font-bold text-ink">Test Controls</h2>
        <p class="text-gray-600 mt-1">Craft your test message and tune the environment.</p>

        <div class="grid gap-5 mt-6">
          <div>
            <label for="from" class="block text-sm font-medium text-gray-800 mb-1">From (optional)</label>
            <input id="from" class="input" inputmode="numeric" placeholder="+12125551234" />
          </div>

          <div>
            <label for="to" class="block text-sm font-medium text-gray-800 mb-1">To (optional)</label>
            <input id="to" class="input" inputmode="numeric" placeholder="+15558675309" />
          </div>

          <div>
            <label for="text" class="block text-sm font-medium text-gray-800 mb-1">Message</label>
            <textarea id="text" class="textarea" placeholder="Type your SMS‚Ä¶"></textarea>
          </div>

          <div class="rounded-2xl border border-gray-200 p-5 bg-slate-50">
            <label class="inline-flex items-center gap-2 text-sm text-gray-900">
              <input id="strictMode" type="checkbox" class="rounded border-gray-300" />
              <span>Stricter content filter (block risky terms/URLs)</span>
            </label>

            <div class="mt-4 grid md:grid-cols-[auto,1fr] items-center gap-3">
              <label class="inline-flex items-center gap-2 text-sm text-gray-900">
                <input id="qhEnabled" type="checkbox" class="rounded border-gray-300" />
                <span>Quiet Hours</span>
              </label>
              <div class="grid grid-cols-2 gap-3">
                <div>
                  <label for="qhStart" class="block text-xs text-gray-600 mb-1">Start</label>
                  <input id="qhStart" type="time" value="21:00" class="input" />
                </div>
                <div>
                  <label for="qhEnd" class="block text-xs text-gray-600 mb-1">End</label>
                  <input id="qhEnd" type="time" value="08:00" class="input" />
                </div>
              </div>
            </div>

            <div class="mt-4">
              <div class="flex items-center justify-between text-sm">
                <label for="filterChance" class="text-gray-900">Carrier Filter Chance</label>
                <span id="chanceLabel" class="text-gray-800 font-semibold">0%</span>
              </div>
              <input id="filterChance" type="range" min="0" max="100" value="0" class="w-full accent-sky mt-2" />
              <p class="text-xs text-gray-500 mt-1">Randomly converts a delivered message to FILTERED with this probability.</p>
            </div>
          </div>

          <!-- Buttons -->
          <div class="button-row">
  <button id="sendBtn" class="btn btn-primary">Check Compliance</button>
  <button id="stopBtn" class="btn btn-outline">Simulate STOP</button>
  <button id="helpBtn" class="btn btn-outline">Simulate HELP</button>
  <button id="csvBtn" class="btn btn-ghost">Download CSV</button>
  <button id="clearBtn" class="btn btn-ghost">Clear</button>
</div>


          <div class="text-xs text-gray-500 mt-1">
            <strong>Privacy:</strong> No real texts are sent. The sandbox runs in your browser and fetches simulated delivery data. No tracking cookies.
          </div>
        </div>
      </section>

      <!-- Conversation -->
      <section class="bg-white rounded-3xl p-6 shadow-card">
        <div class="flex items-center justify-between">
          <h2 class="text-xl font-bold text-ink">Conversation</h2>
          <div id="stats" class="text-sm text-gray-600"></div>
        </div>

        <div class="mt-5 flex justify-center">
          <div class="phone-wrap w-full max-w-sm">
            <div class="phone-bezel">
              <div class="phone-screen">
                <div class="phone-notch"></div>
                <div class="flex items-center justify-between text-[11px] text-gray-700/80 px-3 pt-4 pb-2">
                  <span id="phoneTime"></span>
                  <div class="flex items-center gap-1">
                    <span class="inline-block w-2 h-2 rounded-full bg-gray-700/80"></span>
                    <span class="inline-block w-2 h-2 rounded-full bg-gray-700/80"></span>
                    <span class="inline-block w-4 h-2 bg-gray-700/80 rounded-sm"></span>
                  </div>
                </div>
                <div class="chat-bg border-t border-gray-200/70 px-3 pb-2">
                  <div id="thread" class="h-[520px] overflow-y-auto pt-3 space-y-3" aria-live="polite"></div>
                </div>
                <div class="phone-home"></div>
              </div>
            </div>
          </div>
        </div>

        <div class="text-xs text-gray-500 mt-3">Local time: <span id="localTime"></span></div>
      </section>
    </div>
  </main>

  <!-- ===== Footer (auto-load) ===== -->
  <div id="site-footer" class="mb-10"></div>

  <script>
    // --------- SET YOUR WORKER ENDPOINT ----------
    const API_URL = "https://sandbox-test.ipetranelle.workers.dev/api/sandbox/send";
    // --------------------------------------------

    // Autoload header/footer (relative paths for local + prod)
    (async function(){
      try {
        const h = await fetch('partials/header.html');
        document.getElementById('site-header').innerHTML = h.ok ? await h.text() : defaultHeader();
      } catch { defaultHeader(); }
      try {
        const f = await fetch('partials/footer.html');
        document.getElementById('site-footer').innerHTML = f.ok ? await f.text() : defaultFooter();
      } catch { defaultFooter(); }
    })();

    function defaultHeader(){
      document.getElementById('site-header').innerHTML = `
        <div class="bg-white border-b border-gray-200">
          <div class="max-w-6xl mx-auto px-4 py-4 flex items-center justify-between">
            <a href="/" class="flex items-center gap-3">
              <img src="assets/logo1.png" alt="10dlccheck logo" class="h-8 w-auto" onerror="this.style.display='none'">
              <span class="text-xl font-bold text-ink">10dlccheck</span>
            </a>
            <nav class="text-sm flex items-center gap-5">
              <a class="text-ink/80 hover:text-ink" href="learn/index.html">Learn</a>
            </nav>
          </div>
        </div>`;
    }
    function defaultFooter(){
      document.getElementById('site-footer').innerHTML = `
        <div class="max-w-6xl mx-auto px-4 text-sm text-gray-600">
          <div class="rounded-3xl bg-white shadow-soft px-6 py-5 flex flex-wrap items-center justify-between gap-3">
            <div>¬© <span id="year"></span> 10dlccheck ‚Ä¢ Privacy-first tools.</div>
            <div class="flex items-center gap-4">
           
            </div>
          </div>
        </div>`;
      document.getElementById('year').textContent = new Date().getFullYear();
    }

    // ----- App state -----
    const threadEl = document.getElementById('thread');
    const statsEl  = document.getElementById('stats');
    const localTimeEl = document.getElementById('localTime');
    const state = JSON.parse(localStorage.getItem('sandboxThread') || '[]');

    function render(){
      threadEl.innerHTML = '';
      state.forEach(m => {
        const bubble = document.createElement('div');
        bubble.className = (m.role === 'me'
          ? 'ml-auto max-w-[80%] text-white rounded-2xl px-4 py-2.5 shadow'
          : 'mr-auto max-w-[80%] bg-gray-100 text-gray-900 rounded-2xl px-4 py-2.5 shadow');
        if (m.role === 'me') bubble.style.background = 'var(--sky)';
        bubble.innerHTML = `<div class="text-sm">${m.body}</div><div class="text-[11px] mt-1 opacity-75">${m.meta||''}</div>`;
        threadEl.appendChild(bubble);
      });
      statsEl.textContent = `${state.length} events`;
      threadEl.scrollTop = threadEl.scrollHeight;
      localStorage.setItem('sandboxThread', JSON.stringify(state));
      localTimeEl.textContent = new Date().toLocaleString();
    }
    const push = (role, body, meta='') => { state.push({role, body, meta, ts:new Date().toISOString()}); render(); };

    function toCSV(){
      const rows = [['ts','role','body','meta']];
      state.forEach(m=>rows.push([m.ts,m.role,(m.body||'').replace(/\n/g,' '),m.meta||'']));
      const csv = rows.map(r=>r.map(v=>`"${(v??'').toString().replace(/"/g,'""')}"`).join(',')).join('\n');
      const blob = new Blob([csv], {type:'text/csv'}); const a=document.createElement('a');
      a.href = URL.createObjectURL(blob); a.download='sms-sandbox-log.csv'; a.click();
    }

    // Quiet Hours (local)
    function inQuietHours() {
      const enabled = document.getElementById('qhEnabled').checked;
      if (!enabled) return false;
      const start = document.getElementById('qhStart').value || "21:00";
      const end   = document.getElementById('qhEnd').value   || "08:00";
      const now = new Date(), cur = now.getHours()*60 + now.getMinutes();
      const [sh, sm] = start.split(':').map(Number), [eh, em] = end.split(':').map(Number);
      const S = sh*60 + sm, E = eh*60 + em;
      return (S <= E) ? (cur >= S && cur < E) : (cur >= S || cur < E);
    }

    // Filter chance label
    const chanceInput = document.getElementById('filterChance');
    const chanceLabel = document.getElementById('chanceLabel');
    const updateChanceLabel = () => chanceLabel.textContent = `${chanceInput.value}%`;
    chanceInput.addEventListener('input', updateChanceLabel); updateChanceLabel();

    // Actions
    document.getElementById('sendBtn').onclick = async () => {
      const text = document.getElementById('text').value.trim();
      if (!text) return;
      const from = document.getElementById('from').value.trim();
      const to   = document.getElementById('to').value.trim();
      const strict = document.getElementById('strictMode').checked;

      push('me', text);

      if (inQuietHours()) { push('system', 'DLR: FILTERED', 'Quiet Hours active ‚Äî delivery blocked'); return; }

      try {
        const r = await fetch(API_URL, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ text, from, to, strict })
        });
        const data = await r.json();

        const prob = Number(chanceInput.value) / 100;
        const randomHit = Math.random() < prob;

        let status = data.status;
        let filtered = data.filtered;
        let reason = data.reason || '';
        if (randomHit) { status = 'FILTERED'; filtered = true; reason = 'simulated carrier filter (probability override)'; }

        const meta = `${data.carrier} ‚Ä¢ ${status} ‚Ä¢ Risk ${data.risk_score} ‚Ä¢ ${data.delay_ms}ms`;
        push('system', `DLR: ${status}`, meta);
        if (filtered) push('system','Filtered',`Reason: ${reason || 'content/behavior risk'}`);
      } catch (e) {
        push('system', 'Error calling API', e.message || 'network error');
      }
    };

    document.getElementById('stopBtn').onclick = () => {
      push('peer','STOP','user reply');
      push('system','Auto-response','You have been opted out. Reply START to opt back in.');
    };
    document.getElementById('helpBtn').onclick = () => {
      push('peer','HELP','user reply');
      push('system','Auto-response','Help: Alerts info. Msg&data rates may apply. Reply STOP to opt out.');
    };
    document.getElementById('csvBtn').onclick = toCSV;
    document.getElementById('clearBtn').onclick = () => { state.length = 0; render(); };

    // Clocks
    const setTimes = () => {
      const f={hour:'2-digit',minute:'2-digit'};
      const hero=document.getElementById('phoneTimeHero'); const phone=document.getElementById('phoneTime');
      if (hero) hero.textContent=new Date().toLocaleTimeString([],f);
      if (phone) phone.textContent=new Date().toLocaleTimeString([],f);
      document.getElementById('localTime').textContent = new Date().toLocaleString();
    };
    setTimes(); setInterval(setTimes,1000);
    render();
  </script>
</body>
</html>
